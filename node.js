'use strict';
const fs = require('fs');
const jwt = require('jsonwebtoken');
const crypto = require('crypto');

var privateKEY  = `-----BEGIN PRIVATE KEY-----
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
-----END PRIVATE KEY-----`;

var now = 1715945186; // in sec
var expiry = 1816031578;
var nonce = 12345; // unique value
var apiKey = "513d5dd4-9c7f-4487-b782-a8274cc9700a";
var json = {
  asset: "BTC",
  amount: 0.0675,
  type: "Withdraw",
};
var body = JSON.stringify(json);

var payload = {
 iat: now,
 nonce: nonce,
 exp: expiry,
 sub: apiKey,
 uri: "/wallet/withdraw",
 bodyhash: crypto.createHash('sha256').update(body).digest('hex')
};

var signOptions = {
 algorithm:  "RS256"
};

var token = jwt.sign(payload, privateKEY, signOptions);
console.log("Token :" + token);





